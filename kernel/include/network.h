
extern struct port_list_struct port_list;

struct port_list_struct port_list;

struct port_list_struct * find_port_from_list(unsigned short p_num) {
	struct list_head * pos			= NULL;
	struct port_list_struct * temp	= NULL;

	list_for_each(pos, &port_list.list) {
		temp = list_entry(pos, struct port_list_struct, list);
		if (temp -> port == p_num)
			return temp;
	}
	return NULL;
}

void toggle_port(unsigned short p_num) {
	struct port_list_struct * target = find_port_from_list(p_num);

	if (target == NULL) {
		target = kmalloc(sizeof(struct port_list_struct), GFP_KERNEL);
		target -> port = p_num;
		list_add(&(target -> list), &port_list.list);
	} else {
		list_del(&target->list);
		kfree(target);
	}
}
